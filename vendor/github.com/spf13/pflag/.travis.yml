sudo: false

language: 'go'

arch:
  - 'amd64'
  - 'ppc64le'

go:
  - '1.11'
  - '1.12'
  - '1.13'
  - '1.14'
  - '1.15'
  - 'tip'

matrix:
  allow_failures:
    - go: 'tip'

branches:
  only:
    - 'master'

install:
  - go get golang.org/x/lint/golint
  - export PATH=$GOPATH/bin:$PATH
  - go install ./...

script:
  - diff -u <(echo -n) <(gofmt -d -s .)
  - golint -min_confidence=0.9 ./...
  - go vet ./...
  - go test -v -race -cover ./...
